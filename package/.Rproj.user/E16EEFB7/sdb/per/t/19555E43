{
    "collab_server" : "",
    "contents" : "\n#' @title Competing Risks Models Summary.\n#' @name summarizeCR\n#' @description The function generates summarized report including\n#' p-values of testing differenzes between groups and visualisation of survival\n#' and cumulative incidences curves.\n#' @param time vector with times of an event or follow-up, must be numeric.\n#' @param risk vector with type of event, can be numeric or factor/character.\n#' @param group vector with group variable, can be numeric or factor/character.\n#' @param cens value of 'risk' indicating censored observation (if NULL, the first value of 'risk' vector will be taken).\n#' @param rho rho parameter from Fleming-Harrington Test.\n#' @param target point in time, in which the confidence bounds should be plotted (default NULL, no confidence bounds plotted).\n#' @param type type of survival curve to be fitted. Possible values are \"kaplan-meier\" (default), \"fleming-harrington\" or \"fh2\".\n#' @param conf.int conf.int level of two-sided confidence interval (default = 0.95).\n#' @param conf.type type of confidence interval. Possilble values: \"none\", \"plain\", \"log\" (default), \"log-log\".\n#' @param ggtheme ggtheme to be used in plots (default: theme_minimal()).\n#' @param titleSurv a title of a survival curves plot (default: \"Survival curves\").\n#' @param titleCuminc a title of a cumulative incidences plot (default: \"Cumulative incidence function\").\n#' @param xtitle a title of x axis of survival curves and cumulative incidences plots(default: \"Time\").\n#' @param ytitleSurv a title of y axis of survial curves plot (default: \"Probability of survivng up to time t\").\n#' @param ytitleCuminc a title of y axis (default: \"Cumulative incidences\").\n#' @param legendtitle a title of a legend (default: \"Group\").\n#' @param riskTabTitle a title of table with number at risk.\n#' @param eventTabTitle a title of table with number of events.\n#' @return Results of functions implemented in the package summarised in a one-page raport.\n#' @export\n#' @examples\n#' summarizeCR(time = LUAD$time, risk = LUAD$event, group = LUAD$gender, cens = \"alive\")\n#'\n#' summarizeCR(time = LUAD$time, risk = LUAD$event, group = LUAD$gender, cens = \"alive\",\n#' target = 1200, type = \"fleming-harrington\",  conf.int = 0.99, conf.type = \"log-log\",\n#' ggtheme = theme_bw())\n#'\n#' summarizeCR(time = LUAD$time/365, risk = LUAD$event, group = LUAD$gender, cens = \"alive\",\n#' conf.type = \"plain\", rho = 1)\n#'\n#' summarizeCR(time = LUAD$time, risk = LUAD$event, group = LUAD$gender, cens = \"alive\",\n#' target = 800, type = \"kaplan-meier\", ggtheme = theme_gray(), titleSurv = \"Survival analysis\",\n#' titleCuminc = \"Competing risks models\", xtitle = \"Days\", ytitleSurv = \"Survival curves\",\n#' ytitleCuminc = \"Cumulative incidence functions\", legendtitle = \"Gender\")\n#'\n#' @importFrom gridExtra grid.arrange tableGrob arrangeGrob\n#' @importFrom gtable gtable_add_grob\n#' @importFrom grid segmentsGrob unit\n\n\nsummarizeCR <- function(time,\n                      risk,\n                      group,\n                      cens = NULL,\n                      rho = 0,\n                      target = NULL,\n                      type = \"kaplan-meier\",\n                      conf.int = 0.95,\n                      conf.type = \"log\",\n                      ggtheme = theme_minimal(),\n                      titleSurv = \"Survival curves\",\n                      titleCuminc = \"Cumulative incidence functions\",\n                      xtitle = \"Time\",\n                      ytitleSurv = \"Probability of survivng up to time t\",\n                      ytitleCuminc = \"Cumulative incidences\",\n                      legendtitle = \"Group\",\n                      riskTabTitle = \"Number at risk\",\n                      eventTabTitle = \"Number of events\"\n\n){\n\n\n    fit <- fitSurvival(time, risk, group, cens, type, conf.int, conf.type)\n    ci <- fitCuminc(time, risk, group, cens)\n\n    lrtSurvTest <- testSurvival(time, risk, group, cens, rho)\n    cumincTest <- testCuminc(ci)\n\n\n    fitCox <- fitCox(time, risk, group, cens, conf.int = conf.int)\n    CoxSurvTest <- testCox(fitCox)\n\n    fitReg <- fitReg(time, risk, group, cens)\n    CoxCompTest <-  testReg(fitReg, conf.int)\n\n    #Plots\n    plotSurvCurves <- plotSurvival(fit,\n                                   target,\n                                   ggtheme,\n                                   titleSurv,\n                                   xtitle,\n                                   ytitleSurv,\n                                   legendtitle)\n\n    plotCumFun <- plotCuminc(ci,\n                             cens,\n                             target,\n                             ggtheme,\n                             titleCuminc,\n                             xtitle,\n                             ytitleCuminc,\n                             legendtitle)\n\n    #tables\n    riskTable <- riskTab(time, risk, group, cens, riskTabTitle)\n    # for(i in 1:length(riskTable)){\n    #     assign(paste(\"riskTab\", i, sep = \"\"), riskTable[[i]])\n    # }\n    eventTable <- eventTab(time, risk, group, cens, eventTabTitle)\n    # for(i in 1:length(eventTable)){\n    #     assign(paste(\"eventTab\", i, sep = \"\"), eventTable[[i]])\n    # }\n\n\n    Tests <- rbind(lrtSurvTest, CoxSurvTest, cumincTest, CoxCompTest)\n\n    #Tests\n    Tests <- tableGrob(Tests, theme = ttheme_minimal())\n\n    Tests <- gtable_add_grob(Tests,\n                             grobs = segmentsGrob(\n                                 x0 = unit(0, \"npc\"),\n                                 y0 = unit(0, \"npc\"),\n                                 x1 = unit(1, \"npc\"),\n                                 y1 = unit(0, \"npc\"),\n                                 gp = gpar(lwd = 2)),\n                             t = 5, b = 5, l = 1, r = 3)\n\n\n    lay <- rbind(c(1,2),\n                 c(1,2),\n                 c(1,2),\n                 c(3,4),\n                 c(3,5))\n\n    grid.arrange(plotSurvCurves,\n                 plotCumFun,\n                 Tests,\n                 riskTable,\n                 eventTable,\n                 layout_matrix = lay)\n\n}\n",
    "created" : 1500054942373.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3722408023",
    "id" : "19555E43",
    "lastKnownWriteTime" : 1500054992,
    "last_content_update" : 1500054992309,
    "path" : "~/GitHub/cr17/package/R/crSummary.R",
    "project_path" : "R/crSummary.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}