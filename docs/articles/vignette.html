<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package cr17 - competing risks models and its visualization • cr17</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">cr17</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette.html">Package cr17 - competing risks models and its visualization</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Package cr17 - competing risks models and its visualization</h1>
                        <h4 class="author">Magda Młynarczyk</h4>
            
            <h4 class="date">2017-11-28</h4>
          </div>

    
    
<div class="contents">
<style>
body {
text-align: justify}
</style>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Package cr17 provides an user-friendly tool for testing differences between groups in competing risks models. It also enables generating a summarized report by using just one function <strong>summarizeCR</strong>.</p>
<p>Competing risks models examine the time <span class="math inline">\(T\)</span> to the first occurrence of an event (we refer to an event also as a ‘risk’). As opposed to survival analysis we consider more then one, independent types of events, denoted <span class="math inline">\(j \in \{1,2,...,J\}\)</span> that can occur to each subject. If the event doesn’t happen to a subject, we treat it as <em>censored</em> and we record the time to the last follow-up. To illustrate that lets have a look at sample data:</p>
<table class="table">
<thead><tr class="header">
<th align="right">Patient</th>
<th align="right">Time</th>
<th align="right">Status</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>The column <em>Patient</em> indicates the id of a patient, the column <em>Time</em> indicates time from the beginning of observation to the first event or last follow-up and the column <em>Status</em> indicates the type of an event (0 means that the observation is censored). Having this type of data we would like to model expected duration of time until given type of the event happens. What’s more, using the package cr17, we can examine if the models differ between groups. This type of analysis is crucial in testing efficiency of different types of medical therapies. It can be also applied to many other situations, for example studying time to the first malfunction of a machine (where the group variable can be the condition, the machine was used in, e.g. ambient temperature).</p>
<p>In the package there are implementations of 4 methods for modelling competing risks and 2 plotting functions.</p>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<p>Data attached to the package comes from The Cancer Genome Atlas Project and describes survival times of 522 patients with lung cancer. It contains following columns:</p>
<ul>
<li>
<strong>time</strong> is a time in days from the beginning of an observation to an event or last follow-up,</li>
<li>
<strong>event</strong> is a type of event that have happened (“death”, “new_tumor” or “alive” when the observation was censored),</li>
<li>
<strong>gender</strong> is a gender of a patient (grouping variable).</li>
</ul>
</div>
<div id="survival-curves-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#survival-curves-estimation" class="anchor"></a>Survival curves estimation</h1>
<p>The first approach is to estimate survival curves for each risk separately treating an occurrance of the other event type as censoring. The survival function is a probability of surviving up to a given time. Formally:</p>
<p><span class="math display">\[S(t) = \mathbf{P}(t&lt;T)\]</span></p>
<p>There are 2 basic estimators of survival curves:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Kaplan-Meier estimator:</strong> <span class="math display">\[\hat{S}_{km}(t) = \prod_{t_i \leq t} (1-\hat{q_{i}}) =  \prod_{t_i \leq t} \left(1 - \frac{d_{i}}{n_{i}}\right)\]</span>
</li>
<li>
<strong>Flemming-Harrington estimator:</strong> <span class="math display">\[\hat{S}_{fh}(t) = \exp(-\hat{H}_{fh} (t))\]</span> where: <span class="math display">\[\hat{H}_{fh} (t) = \sum_{i: t_{i} \leq t} \frac{d_i}{r_i}\]</span>
</li>
</ol>
<p>The package cr17 contains <strong>fitSurvival</strong> function that computes estimations of survival curves for each risk in each group. The arguments of the function are:</p>
<ul>
<li>
<strong>time</strong> - vector with times of the first event or last follow-up, must be numeric,</li>
<li>
<strong>risk</strong> - vector with type of event, can be numeric or factor/character,</li>
<li>
<strong>group</strong> - vector with group variable, can be numeric or factor/character,</li>
<li>
<strong>cens</strong> - value of ‘risk’ indicating censored observation (if NULL, the first value of ‘risk’ vector will be taken),</li>
<li>
<strong>type</strong> - type of survival curve to be fitted. Possible values are “kaplan-meier” (default), “fleming-harrington” or “fh2” (the variation of Flemming Harrington estimator),</li>
<li>
<strong>conf.int</strong> - level of two-sided confidence interval (default = 0.95),</li>
<li>
<strong>conf.type</strong> - type of confidence interval. Possible values: “none”, “plain”, “log” (default), “log-log”,</li>
</ul>
<p>Basic usage:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">survivalCurves &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitSurvival.html">fitSurvival</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time,
                              <span class="dt">risk =</span> LUAD<span class="op">$</span>event, 
                              <span class="dt">group =</span> LUAD<span class="op">$</span>gender,
                              <span class="dt">cens =</span> <span class="st">"alive"</span>)</code></pre></div>
<p>survivalCurves is now a list of two elements of class summary.survfit [1], corresponding to each risk:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(survivalCurves)
## [1] "death"     "new_tumor"</code></pre></div>
<p>Each element of a list contains estimation of survival curves for given risk in each group. We can extract the estimation of survival curve for a given risk and group:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SC &lt;-<span class="st"> </span>survivalCurves<span class="op">$</span>death[<span class="kw">c</span>(<span class="st">"time"</span>, 
                       <span class="st">"n.risk"</span>, 
                       <span class="st">"n.event"</span>, 
                       <span class="st">"n.censor"</span>, 
                       <span class="st">"surv"</span>, 
                       <span class="st">"strata"</span>,
                       <span class="st">"std.err"</span>,
                       <span class="st">"lower"</span>,
                       <span class="st">"upper"</span>)]

SC &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(SC)
SC &lt;-<span class="st"> </span><span class="kw">filter</span>(SC, strata <span class="op">==</span><span class="st"> "male"</span>)

<span class="kw">kable</span>(<span class="kw">head</span>(SC, <span class="dt">n =</span> <span class="dv">10</span>))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">n.risk</th>
<th align="right">n.event</th>
<th align="right">n.censor</th>
<th align="right">surv</th>
<th align="left">strata</th>
<th align="right">std.err</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">233</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="right">0.9957082</td>
<td align="left">male</td>
<td align="right">0.0042826</td>
<td align="right">0.9873496</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="right">33</td>
<td align="right">190</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">0.9904676</td>
<td align="left">male</td>
<td align="right">0.0067429</td>
<td align="right">0.9773394</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="right">38</td>
<td align="right">185</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">0.9851137</td>
<td align="left">male</td>
<td align="right">0.0085724</td>
<td align="right">0.9684546</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="right">62</td>
<td align="right">165</td>
<td align="right">1</td>
<td align="right">18</td>
<td align="right">0.9791433</td>
<td align="left">male</td>
<td align="right">0.0103936</td>
<td align="right">0.9589826</td>
<td align="right">0.9997279</td>
</tr>
<tr class="odd">
<td align="right">74</td>
<td align="right">159</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">0.9729852</td>
<td align="left">male</td>
<td align="right">0.0120149</td>
<td align="right">0.9497192</td>
<td align="right">0.9968212</td>
</tr>
<tr class="even">
<td align="right">87</td>
<td align="right">154</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">0.9666671</td>
<td align="left">male</td>
<td align="right">0.0134962</td>
<td align="right">0.9405737</td>
<td align="right">0.9934844</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">151</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.9602653</td>
<td align="left">male</td>
<td align="right">0.0148477</td>
<td align="right">0.9316009</td>
<td align="right">0.9898117</td>
</tr>
<tr class="even">
<td align="right">97</td>
<td align="right">149</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.9538206</td>
<td align="left">male</td>
<td align="right">0.0160860</td>
<td align="right">0.9228079</td>
<td align="right">0.9858755</td>
</tr>
<tr class="odd">
<td align="right">118</td>
<td align="right">138</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0.9469089</td>
<td align="left">male</td>
<td align="right">0.0173911</td>
<td align="right">0.9134291</td>
<td align="right">0.9816157</td>
</tr>
<tr class="even">
<td align="right">161</td>
<td align="right">127</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0.9394529</td>
<td align="left">male</td>
<td align="right">0.0187846</td>
<td align="right">0.9033479</td>
<td align="right">0.9770009</td>
</tr>
</tbody>
</table>
<p>Survival curves can be plotted by using the <strong>plotSurvival</strong> function. The <strong>target</strong> argument allows to plot a confidence interval in a given point in time. It is possible to choose the ggplot theme of a plot (<strong>ggtheme</strong> argument) as well as title of a plot (<strong>titleSurv</strong>), axis (<strong>xtitle</strong>, <strong>ytitle</strong>) and of a legend (<strong>legentitle</strong>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotSurvival.html">plotSurvival</a></span>(<span class="dt">fit =</span> survivalCurves,
             <span class="dt">target =</span> <span class="dv">1500</span>,
             <span class="dt">ggtheme =</span> <span class="kw">theme_gray</span>(),
             <span class="dt">legendtitle =</span> <span class="st">"Gender"</span>)</code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-6-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Now, to test differences between groups in models, using <strong>Flemming-Harrington Test</strong> [1], one can use the <strong>testSurvival</strong> function. By choosing the parameter <strong>rho</strong> to be 0, we get the result of a log-rank test:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/testSurvival.html">testSurvival</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time, 
             <span class="dt">risk =</span> LUAD<span class="op">$</span>event, 
             <span class="dt">group =</span> LUAD<span class="op">$</span>gender, 
             <span class="dt">cens =</span> <span class="st">"alive"</span>, 
             <span class="dt">rho =</span> <span class="dv">0</span>)
##                         death new_tumor
## Fleming-Harrington test  0.76      0.99</code></pre></div>
</div>
<div id="cox-models" class="section level1">
<h1 class="hasAnchor">
<a href="#cox-models" class="anchor"></a>Cox models</h1>
<p>The other approach of modelling survival analysis is to use so called Cox models. Again, we can use it in case of competing risks by creating a model for each type of event separately, treating other events as censoring. To understand the idea behind the Cox models, we need to know the definition of hazard function: <span class="math display">\[h(t) = lim_{\epsilon \to 0} \frac{\mathbf{P}(t&lt;T&lt;t+\epsilon|T&gt;t)}{\epsilon}\]</span></p>
<p>Cox model assumes following form of a hazard function: <span class="math display">\[h_1(t, z_1, z_2,...,z_m) = h_0(t) e^{\beta_1z_1 + \beta_2z_2 +...+ \beta_mz_m}\]</span> where:</p>
<ul>
<li>
<span class="math inline">\(h_0\)</span> is a baseline hazard function (not specified),</li>
<li>
<span class="math inline">\(z_1,z_2,...,z_m\)</span> are the time independent predictors,</li>
<li>
<span class="math inline">\(\beta_1,\beta_2,...,\beta_m\)</span> are parameters.</li>
</ul>
<p>Estimation of Cox models for each risk separately can be done by <strong>fitCox</strong> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coxModel &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simpleCox.html">fitCox</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time,
              <span class="dt">risk =</span> LUAD<span class="op">$</span>event,
              <span class="dt">group =</span> LUAD<span class="op">$</span>gender,
              <span class="dt">cens =</span> <span class="st">"alive"</span>,
              <span class="dt">conf.int =</span> <span class="fl">0.95</span>)</code></pre></div>
<p>The result of the function is a list, which elements are objects of class summary.coxph [1] for each risk.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(coxModel)
## [1] "death"     "new_tumor"</code></pre></div>
<p>We can extract the estimated parameteres of the models:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coxModel<span class="op">$</span>death<span class="op">$</span>coefficients
##                       coef exp(coef)  se(coef)          z Pr(&gt;|z|)
## localGroupmale -0.06014372 0.9416292 0.1997595 -0.3010807 0.763353</code></pre></div>
<p>Testing differences between groups can be done with the <strong>testCox</strong> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw"><a href="../reference/testCox.html">testCox</a></span>(<span class="dt">fitCox =</span> coxModel))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">death</th>
<th align="right">new_tumor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Likelihood ratio test</td>
<td align="right">0.76</td>
<td align="right">0.99</td>
</tr>
<tr class="even">
<td>Wald test</td>
<td align="right">0.76</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td>Logrank test</td>
<td align="right">0.76</td>
<td align="right">0.99</td>
</tr>
</tbody>
</table>
</div>
<div id="cumulative-incidence-function" class="section level1">
<h1 class="hasAnchor">
<a href="#cumulative-incidence-function" class="anchor"></a>Cumulative incidence function</h1>
<p>Cumulative incidence function is the probability of surviving up to time <span class="math inline">\(t\)</span>, if the first event is of type <span class="math inline">\(j\)</span>: <span class="math display">\[F_{j}(t) = \mathbf{P}(T \leq t, \delta = j) = \int_0^t h_{j}(u)S(u)du, \ \ \ j \in \{1,2,3,...,J\},\]</span> where <span class="math inline">\(\delta\)</span> is a type of an event. Estimation of this function we obtain with function <strong>fitCuminc</strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cuminc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitCuminc.html">fitCuminc</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time,
                    <span class="dt">risk =</span> LUAD<span class="op">$</span>event,
                    <span class="dt">group =</span> LUAD<span class="op">$</span>gender,
                    <span class="dt">cens =</span> <span class="st">"alive"</span>)
## 19 cases omitted due to missing values</code></pre></div>
<p>The object ‘cuminc’ is now a list containing 5 elements, where first 4 are the estimations of the cumulative incidence function for each combination of a risk and a group. The last element of a list is a result of a K-sample test [2]:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(cuminc)
## [1] "female death"     "male death"       "female new_tumor"
## [4] "male new_tumor"   "Tests"</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">femaleDeathCuminc &lt;-<span class="st"> </span>cuminc[[<span class="st">"female death"</span>]]

femaleDeathCuminc &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(femaleDeathCuminc)

<span class="kw">kable</span>(<span class="kw">head</span>(femaleDeathCuminc))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">time</th>
<th align="right">est</th>
<th align="right">var</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">0.0039683</td>
<td align="right">0.0000157</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">0.0039683</td>
<td align="right">0.0000157</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">0.0081887</td>
<td align="right">0.0000334</td>
</tr>
<tr class="even">
<td align="right">22</td>
<td align="right">0.0081887</td>
<td align="right">0.0000334</td>
</tr>
</tbody>
</table>
<p>We obtain plots of cumulative incidence curves by using the <strong>plotCuminc</strong> function. Again, we can choose a point in time, at which the confidence intervals will be plotted. We can also adjust the title of the plot, of the axes and of the legend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotCuminc.html">plotCuminc</a></span>(<span class="dt">ci =</span> cuminc,
           <span class="dt">cens =</span> <span class="st">"alive"</span>,
           <span class="dt">target =</span> <span class="dv">1500</span>,
           <span class="dt">ggtheme =</span> <span class="kw">theme_gray</span>(),
           <span class="dt">legendtitle =</span> <span class="st">"Gender"</span>)</code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-15-1.png" width="700" style="display: block; margin: auto;"> P-values of K-sample test can be extracted by <strong>testCuminc</strong> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/testCuminc.html">testCuminc</a></span>(cuminc) 
##               death new_tumor
## K-Sample test  0.83      0.98</code></pre></div>
</div>
<div id="cox-models-for-competing-risks" class="section level1">
<h1 class="hasAnchor">
<a href="#cox-models-for-competing-risks" class="anchor"></a>Cox models for competing risks</h1>
<p>The last approach offered by a cr17 package is to use the Cox models for competing risks. The hazard function is now: <span class="math display">\[h_j(t) = h_{j0}(t) \exp(Z^{\mathbf{T}}\beta_0),\]</span> where <span class="math inline">\(h_{jo}\)</span> is the baseline hazard function for risk <span class="math inline">\(j\)</span>. Estimation of this function can be obtained by <strong>fitReg</strong> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitReg.html">fitReg</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time,
              <span class="dt">risk =</span> LUAD<span class="op">$</span>event,
              <span class="dt">group =</span> LUAD<span class="op">$</span>gender,
              <span class="dt">cens =</span> <span class="st">"alive"</span>)
## 19 cases omitted due to missing values
## 19 cases omitted due to missing values</code></pre></div>
<p>The result is a list of length two with estimations of Cox models for competing risks for each type of event. Analogously as in case of <strong>fitCox</strong> function we can obtain coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg<span class="op">$</span>death<span class="op">$</span>coef
##  covMatrix1 
## -0.04556408</code></pre></div>
<p>and we can test the differences between groups with modified likelihood ratio test:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/testReg.html">testReg</a></span>(reg)
##                                death new_tumor
## CompRisk likelihood ratio test  0.82      0.91</code></pre></div>
</div>
<div id="diagnosic-tables" class="section level1">
<h1 class="hasAnchor">
<a href="#diagnosic-tables" class="anchor"></a>Diagnosic tables</h1>
<p>The package contains two functions returning diagnostic tables. A result of <strong>riskTab</strong> function is a table with number of subjects at risk in given groups, and a result of <strong>eventTab</strong> function is a table with number of events that have happened up to the given time points.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/riskTab.html">riskTab</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time,
        <span class="dt">risk =</span> LUAD<span class="op">$</span>event,
        <span class="dt">group =</span> LUAD<span class="op">$</span>gender,
        <span class="dt">cens =</span> <span class="st">"alive"</span>,
        <span class="dt">title =</span> <span class="st">"Number at risk"</span>)</code></pre></div>
<div class="figure">
<img src="riskTab.png">
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eventTab.html">eventTab</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time,
        <span class="dt">risk =</span> LUAD<span class="op">$</span>event,
        <span class="dt">group =</span> LUAD<span class="op">$</span>gender,
        <span class="dt">cens =</span> <span class="st">"alive"</span>,
        <span class="dt">title =</span> <span class="st">"Number of events"</span>)</code></pre></div>
<p><img src="eventTab.png"> #summarizeCR function To simplify the way of using a package we created function <strong>summarizeCR</strong> that gather results of all functions described above in a one-page report. Basic usage:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/summarizeCR.html">summarizeCR</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time, 
            <span class="dt">risk =</span> LUAD<span class="op">$</span>event, 
            <span class="dt">group =</span> LUAD<span class="op">$</span>gender, <span class="dt">cens =</span> <span class="st">"alive"</span>)</code></pre></div>
<div class="figure">
<img src="rsz_basic_summarizecr.png">
</div>
<p>The report consists of 3 parts. In the upper part, there are plots of survival and cumulative incidence function. In the lower part, on the left hand side we see p-values of tests examining differences in models between groups. The bold line separates the test for survival analysis and for competing risks models. On the right hand, side we see tables with number at risks and number of events.</p>
<p>The report can be rearranged in few ways. First of all, adding the parameter <strong>target</strong>, the confindence intervals can be plotted. Secondly, we can choose the theme of the plots (argument <strong>ggtheme</strong>). And finaly, we can rename plots, axis, legends and tables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/summarizeCR.html">summarizeCR</a></span>(<span class="dt">time =</span> LUAD<span class="op">$</span>time, 
            <span class="dt">risk =</span> LUAD<span class="op">$</span>event, 
            <span class="dt">group =</span> LUAD<span class="op">$</span>gender, 
            <span class="dt">cens =</span> <span class="st">"alive"</span>, 
            <span class="dt">rho =</span> <span class="dv">1</span>, 
            <span class="dt">target =</span> <span class="dv">800</span>, 
            <span class="dt">type =</span> <span class="st">"kaplan-meier"</span>, 
            <span class="dt">ggtheme =</span> <span class="kw">theme_gray</span>(), 
            <span class="dt">titleSurv =</span> <span class="st">"Survival analysis"</span>, 
            <span class="dt">titleCuminc =</span> <span class="st">"Competing risks models"</span>, 
            <span class="dt">xtitle =</span> <span class="st">"Days"</span>, 
            <span class="dt">ytitleSurv =</span> <span class="st">"Survival curves"</span>, 
            <span class="dt">ytitleCuminc =</span> <span class="st">"Cumulative incidence functions"</span>, 
            <span class="dt">legendtitle =</span> <span class="st">"Gender"</span>)</code></pre></div>
<div class="figure">
<img src="rsz_adv_summarizecr.png">
</div>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>The package cr17 provides multiple methods for analysing competing risks data. It enables estimations of models, diagnostic plots and tables as well as results of tests examining differences in models between groups.</p>
</div>
<div id="bibliography" class="section level1">
<h1 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h1>
<ul>
<li><p>Therneau T (2015). <em>A Package for Survival Analysis in S</em>. version 2.38, &lt;URL: <a href="https://CRAN.R-project.org/package=survival" class="uri">https://CRAN.R-project.org/package=survival</a>&gt;. Terry M. Therneau and Patricia M. Grambsch (2000). <em>Modeling Survival Data: Extending the Cox Model</em>. Springer, New York. ISBN 0-387-98784-3.</p></li>
<li><p>Bob Gray (2014). cmprsk: Subdistribution Analysis of Competing Risks. R package version 2.2-7. <a href="https://CRAN.R-project.org/package=cmprsk" class="uri">https://CRAN.R-project.org/package=cmprsk</a></p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#data">Data</a></li>
      <li><a href="#survival-curves-estimation">Survival curves estimation</a></li>
      <li><a href="#cox-models">Cox models</a></li>
      <li><a href="#cumulative-incidence-function">Cumulative incidence function</a></li>
      <li><a href="#cox-models-for-competing-risks">Cox models for competing risks</a></li>
      <li><a href="#diagnosic-tables">Diagnosic tables</a></li>
      <li><a href="#summary">Summary</a></li>
      <li><a href="#bibliography">Bibliography</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Magda Młynarczyk, Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
